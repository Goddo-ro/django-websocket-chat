{% extends "base.html" %}

{% load static %}

{% block title %} –ì—Ä—É–ø–ø–∞ {{ group.name|safe }} {% endblock %}

{% block content %}
  {% include '../includes/sidebar.html' %}
    <script type="text/javascript" src="{% static 'js/auto_textarea_resizing.js' %}"></script>
    <div class='content col-xl-9 h-100' onload="autoheight('chat-message-input')">
      {% if is_member %}
        <h1 class='title'>–ß–∞—Ç: {{ group.name|safe }}</h1>
        <div class="chat col-12">
            <div id="chat-log">
              {% for message in messages.all %}
                {% if message.user == user %}
                  <div class='message current-user-message'>
                    <span class='message__author'>
                      {% if message.user.username %}
                        {{ message.user.username }} 
                      {% else %}
                        –ê–Ω–æ–Ω–∏–º–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
                      {% endif %}
                    </span>
                    <p class='message__text'>{{message.text|safe}}</p>
                    <span class='message__time'>{{ message.time }} </span>
                  </div>
                {% else %}
                  <div class='message'>
                    <span class='message__author'>
                      {{ message.user.username }} 
                    </span>
                    <p class='message__text'>{{message.text|safe}}</p>
                    <span class='message__time'>{{ message.time }} </span>
                  </div>
                {% endif %}
              {% endfor %}
            </div>
            <textarea class='auto-height' 
                      id="chat-message-input"
                      type="text" maxlength="1024" 
                      autofocus placeholder="–í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."
                      oninput="autoheight('chat-message-input')"
                      style="width: 100%;">
            </textarea>
            <input id="chat-message-submit" type="button" value="–û—Ç–ø—Ä–∞–≤–∏—Ç—å">
        </div>
        {% include '../includes/websocket_data.html' with connection_type=connection_type connection_name=group.slug %}
      {% else %}
        <h1 class='title'>–í—ã –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç–µ –≤ —ç—Ç–æ–π –≥—Ä—É–ø–ø–µ üòî</h1>
      {% endif %}
    </div>
{% endblock %}